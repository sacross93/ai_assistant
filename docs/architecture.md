# 시스템 아키텍처

이 문서는 AI 어시스턴트 애플리케이션의 상위 수준 아키텍처를 설명합니다. 시스템은 **프론트엔드**, **Next.js 백엔드**, **파이썬 백엔드**라는 세 가지 주요 구성 요소로 나뉩니다.

```mermaid
graph TD
    User[사용자] -->|상호작용| Frontend[프론트엔드 (Next.js UI)]
    
    subgraph "Node.js 환경"
        Frontend -->|인증 및 사용자 관리| NextBackend[Next.js 백엔드 API]
        NextBackend -->|읽기/쓰기| DB[(SQLite 데이터베이스)]
    end
    
    subgraph "Python 환경"
        Frontend -->|에이전트 목록 조회 / 채팅| PyBackend[파이썬 백엔드 (AI)]
        PyBackend -->|제공| LLM[LLM 에이전트 & 모델]
    end
```

---

## 1. 프론트엔드 (사용자 인터페이스)
**역할**: 사용자가 AI 에이전트와 대화하고 계정을 관리할 수 있는 대화형 인터페이스를 제공합니다.

- **기술 스택**: 
  - **프레임워크**: [Next.js](https://nextjs.org/) (App Router)
  - **라이브러리**: Javascript/React
- **주요 기능**:
  - 채팅 인터페이스 및 에이전트 선택 목록 렌더링.
  - **Next.js 백엔드**와 통신하여 로그인, 회원가입, 세션 검증 처리.
  - **파이썬 백엔드**와 통신하여:
    - 사용 가능한 LLM 에이전트 목록 조회.
    - 사용자 질의 전송 및 AI 응답 수신.
- **현재 상태**: `app` 디렉토리 내에 구현됨.

## 2. Next.js 백엔드 (관리 계층)
**역할**: 관리 작업, 인증, 사용자 계정 데이터의 영구 저장을 담당합니다.

- **기술 스택**:
  - **런타임**: Node.js (Next.js API Routes 활용)
  - **데이터베이스**: `better-sqlite3` (SQLite)
  - **인증**: `jose` (JWT 처리), `bcryptjs` (비밀번호 해싱)
  - **미들웨어**: 세션 보호를 위한 커스텀 `middleware.js`.
- **주요 기능**:
  - **인증**: 사용자 자격 증명 확인 및 JWT 세션 쿠키 발급.
  - **사용자 관리**: 사용자 생성, 삭제, 권한(관리자/일반) 관리.
  - **세션 제어**: 비공개 경로(예: `/admin`)에 대한 무단 접근 방지.

## 3. 파이썬 백엔드 (AI 계층)
**역할**: 애플리케이션의 "두뇌" 역할을 하며, 모든 AI 관련 처리를 담당합니다.

- **기술 스택 (예정)**: 
  - **언어**: Python
  - **프레임워크**: FastAPI
- **주요 기능**:
  - **LLM 연동**: 거대 언어 모델(LLM)과 상호작용.
  - **에이전트 레지스트리**: 사용 가능한 특화 에이전트(예: 번역, 요약, 특정 RAG 봇 등) 목록 관리.
  - **처리**: 프론트엔드로부터 자연어 질의를 받아 처리하고, 응답을 스트리밍.
- **상호작용**:
  - 프론트엔드는 이 백엔드에 활성화된 에이전트 목록을 요청합니다.
  - 실제 채팅 트래픽은 프론트엔드와 파이썬 백엔드 사이에서 직접 오갑니다.
